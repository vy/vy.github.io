<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Calling a Scala Method with a Java Reserved Keyword</title>
    <link rel="stylesheet" href="/css/common.css">
    <meta name="generator" content="nanoc 3.8.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/post.css">
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-40183531-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body>
    <div id="container">

      <ul id="menu">
        <li><a href="/">Home</a></li><li><a href="/blog/">Blog</a></li><li><a href="/code/">Code</a></li><li><a href="/blog/feed/">Feed</a></li>
      </ul>

    

<div id="post">

    <div class="head">
        <div class="title">Calling a Scala Method with a Java Reserved Keyword</div>
        <div class="subtitle">posted at
            November 20, 2015
            with tags <a href="/blog/tag/java">java</a>, <a href="/blog/tag/scala">scala</a>
        </div>
    </div>

    <div class="body">

        <script type="text/javascript">
        var asyncLoadRequests = [];
        </script>

        
<p>At work, there are a couple of JAX-RS microservices I develop and maintain.
Fortunately, all of these services and their consumers are written in Scala.
Up until now, I have never needed to access the service APIs from Java. But
some other team recently needed to do that! And that was where shit hit the
fan. Consider the following <code>ScalaApi</code> class:</p>

<pre><code class="language-scala"><span class="k">class</span> <span class="nc">ScalaApi</span> <span class="o">{</span>

  <span class="k">def</span> <span class="n">default</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"test"</span>

<span class="o">}</span></code></pre>

<p>Did you notice something wrong with the class methods? While it is perfectly
legitimate to use <code>default</code> as a keyword in the JVM byte code, it is not
allowed by the <a href="http://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#jls-3.9">Java Language Specification
3.9</a>.
(Another slightly related discussion: <a href="http://stackoverflow.com/questions/423994/reserved-words-as-variable-or-method-names">Reserved words as variable or method
names</a>.)
Hence, you cannot access it via a simple <code>new ScalaApi().default()</code> call in
Java. To the best of my knowledge, your only safe bet becomes using Javaâ€™s
Reflection API:</p>

<pre><code class="language-java"><span class="kn">import</span> <span class="nn">java.lang.reflect.Method</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Consumer</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ScalaApi</span> <span class="n">scalaApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">ScalaApi</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">scalaApiDefault</span> <span class="o">=</span> <span class="n">scalaApiDefault</span><span class="o">(</span><span class="n">scalaApi</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"ScalaApi#default: "</span> <span class="o">+</span> <span class="n">scalaApiDefault</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">scalaApiDefault</span><span class="o">(</span><span class="n">ScalaApi</span> <span class="n">scalaApi</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">scalaApi</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getDeclaredMethod</span><span class="o">(</span><span class="s">"default"</span><span class="o">);</span>
            <span class="k">return</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">scalaApi</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchMethodException</span> <span class="o">|</span> <span class="n">InvocationTargetException</span> <span class="o">|</span> <span class="n">IllegalAccessException</span> <span class="n">cause</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">cause</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>

<p>This issue raised the following question: <em>Where did I make a mistake?</em> I
believe, it is not possible to come up with a universally legitimate API
targeting all available languages that compile to JVM byte code. I think that
is one of the reasons why programming languages provide constructs to use
reserved keywords in the source code, such as <code>reserved</code> in Scala or
<code>@reserved</code> in C#, etc.</p>


        <div id="disqus_thread"></div>
        <script type="text/javascript">
        var disqus_shortname = 'vyazici';
        var disqus_identifier = '/blog/post/20151120-scala-method-with-java-reserved-keyword/';
        var disqus_title = 'Calling a Scala Method with a Java Reserved Keyword';
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        </script>

        

        

    </div>
  </body>
</html>


        <script type="text/javascript">
        for (var i = 0; i < asyncLoadRequests.length; i++) {
            asyncLoadRequest = asyncLoadRequests[i];
            asyncLoadRequest();
        }
        </script>

    </div>

</div>
