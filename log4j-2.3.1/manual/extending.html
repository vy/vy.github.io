<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
   this work for additional information regarding copyright ownership.
   The ASF licenses this file to You under the Apache License, Version 2.0
   (the "License"); you may not use this file except in compliance with
   the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->
<!-- Generated by Apache Maven Doxia at 2021-12-20 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>Log4j &#x2013; Extending Log4j 2 - Apache Log4j 2</title>
		<link rel="stylesheet" href="../css/bootstrap.min.css" type="text/css" />
		<link rel="stylesheet" href="../css/site.css" type="text/css" />
		<script type="text/javascript" src="../js/jquery.min.js"></script>
		<script type="text/javascript" src="../js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../js/prettify.min.js"></script>
		<script type="text/javascript" src="../js/site.js"></script>
			<meta name="author" content="Ralph Goers" />
		<meta name="Date-Revision-yyyymmdd" content="20211220" />
		<meta http-equiv="Content-Language" content="en" />
		<!-- TODO: add in documentation regarding plugin builders, factories, and typed attributes -->
				</head>
	<body class="composite">
		<img class="logo-left" src="../images/ls-logo.jpg" alt="Apache logging services logo" />
		<img class="logo-right" src="../images/logo.jpg" alt="Apache log4j logo" />
		<div class="clear"></div>

		<div class="navbar">
			<div class="navbar-inner">
				<div class="container-fluid">
					<a class="brand" href="http://logging.apache.org/log4j/2.x/">Apache Log4j 2 &trade;</a>
						<ul class="nav">
						<li>
					
				
				<a href="http://wiki.apache.org/logging" class="external" target="_blank" title="Logging Wiki">Logging Wiki</a>
			</li>
					<li>
					
				
				<a href="http://www.apache.org/" class="external" target="_blank" title="Apache">Apache</a>
			</li>
					<li>
									<a href="../../../" title="Logging Services">Logging Services</a>
			</li>
					<li>
					
				
				<a href="https://analysis.apache.org/dashboard/index/org.apache.logging.log4j:log4j" class="external" target="_blank" title="Sonar">Sonar</a>
			</li>
		</ul>
				</div>
			</div>
		</div>

		<div class="container-fluid">
			<table class="layout-table">
				<tr>
					<td class="sidebar">
						<div class="well sidebar-nav">
										<ul class="nav nav-list">
		 											 <li class="nav-header"><i class="icon-home"></i>Apache Log4jâ„¢ 2</li>
																						<li class="none">
									<a href="../index.html" title="About">About</a>
					</li>
 																<li class="none">
									<a href="../download.html" title="Download">Download</a>
					</li>
 																<li class="none">
									<a href="../maven-artifacts.html" title="Maven and Ivy">Maven and Ivy</a>
					</li>
 																<li class="none">
									<a href="../build.html" title="Build">Build</a>
					</li>
 																<li class="none">
									<a href="../guidelines.html" title="Guidelines">Guidelines</a>
					</li>
 																<li class="none">
									<a href="../javastyle.html" title="Style Guide">Style Guide</a>
					</li>
 																<li class="none">
									<a href="../changelog.html" title="Changelog">Changelog</a>
					</li>
 																																																																				<li class="collapsed">
									<a href="../javadoc.html" title="Javadoc">Javadoc</a>
										</li>
 																<li class="none">
									<a href="../runtime-dependencies.html" title="Runtime Dependencies">Runtime Dependencies</a>
					</li>
 																<li class="none">
									<a href="../faq.html" title="FAQ">FAQ</a>
					</li>
 																<li class="none">
									<a href="../articles.html" title="Articles">Articles</a>
					</li>
 								</ul>
			<ul class="nav nav-list">
		 											 <li class="nav-header"><i class="icon-book"></i>Manual</li>
																						<li class="none">
									<a href="../manual/index.html" title="Introduction">Introduction</a>
					</li>
 																<li class="none">
									<a href="../manual/architecture.html" title="Architecture">Architecture</a>
					</li>
 																<li class="none">
									<a href="../manual/migration.html" title="Log4j 1.x Migration">Log4j 1.x Migration</a>
					</li>
 																																																																													<li class="collapsed">
									<a href="../manual/api.html" title="API">API</a>
										</li>
 																																																																																																																																																																							<li class="collapsed">
									<a href="../manual/configuration.html" title="Configuration">Configuration</a>
										</li>
 																																																																																						<li class="collapsed">
									<a href="../manual/webapp.html" title="Web Applications and JSPs">Web Applications and JSPs</a>
										</li>
 																																																																													<li class="collapsed">
									<a href="../manual/plugins.html" title="Plugins">Plugins</a>
										</li>
 																																																																																																																																			<li class="collapsed">
									<a href="../manual/lookups.html" title="Lookups">Lookups</a>
										</li>
 																																																																																																																																																																																																																				<li class="collapsed">
									<a href="../manual/appenders.html" title="Appenders">Appenders</a>
										</li>
 																																																																																																																	<li class="collapsed">
									<a href="../manual/layouts.html" title="Layouts">Layouts</a>
										</li>
 																																																																																																																										<li class="collapsed">
									<a href="../manual/filters.html" title="Filters">Filters</a>
										</li>
 																																																																																						<li class="collapsed">
									<a href="../manual/async.html" title="Async Loggers">Async Loggers</a>
										</li>
 																<li class="none">
									<a href="../manual/jmx.html" title="JMX">JMX</a>
					</li>
 																<li class="none">
									<a href="../manual/logsep.html" title="Logging Separation">Logging Separation</a>
					</li>
 																																																																																																																													<li class="expanded active">
									<a href="../manual/extending.html" title="Extending Log4j">Extending Log4j</a>
										<ul>
																			<li class="none">
									<a href="../manual/extending.html#LoggerContextFactory" title="LoggerContextFactory">LoggerContextFactory</a>
					</li>
 																				<li class="none">
									<a href="../manual/extending.html#ContextSelector" title="ContextSelector">ContextSelector</a>
					</li>
 																				<li class="none">
									<a href="../manual/extending.html#ConfigurationFactory" title="ConfigurationFactory">ConfigurationFactory</a>
					</li>
 																				<li class="none">
									<a href="../manual/extending.html#LoggerConfig" title="LoggerConfig">LoggerConfig</a>
					</li>
 																				<li class="none">
									<a href="../manual/extending.html#Lookups" title="Lookups">Lookups</a>
					</li>
 																				<li class="none">
									<a href="../manual/extending.html#Filters" title="Filters">Filters</a>
					</li>
 																				<li class="none">
									<a href="../manual/extending.html#Appenders" title="Appenders">Appenders</a>
					</li>
 																				<li class="none">
									<a href="../manual/extending.html#Layouts" title="Layouts">Layouts</a>
					</li>
 																				<li class="none">
									<a href="../manual/extending.html#PatternConverters" title="PatternConverters">PatternConverters</a>
					</li>
 																				<li class="none">
									<a href="../manual/extending.html#Custom_Plugins" title="Custom Plugins">Custom Plugins</a>
					</li>
 										</ul>
							</li>
 																																																		<li class="collapsed">
									<a href="../manual/customconfig.html" title="Extending Log4j Configuration">Extending Log4j Configuration</a>
										</li>
 																																																																																						<li class="collapsed">
									<a href="../manual/customloglevels.html" title="Custom Log Levels">Custom Log Levels</a>
										</li>
 								</ul>
			<ul class="nav nav-list">
		 											 <li class="nav-header"><i class="icon-cog"></i>Components</li>
																						<li class="none">
									<a href="../log4j-api/index.html" title="API">API</a>
					</li>
 																<li class="none">
									<a href="../log4j-core/index.html" title="Implementation">Implementation</a>
					</li>
 																<li class="none">
									<a href="../log4j-jcl/index.html" title="Commons Logging Bridge">Commons Logging Bridge</a>
					</li>
 																<li class="none">
									<a href="../log4j-1.2-api/index.html" title="Log4j 1.2 API">Log4j 1.2 API</a>
					</li>
 																<li class="none">
									<a href="../log4j-slf4j-impl/index.html" title="SLF4J Binding">SLF4J Binding</a>
					</li>
 																<li class="none">
									<a href="../log4j-jul/index.html" title="JUL Adapter">JUL Adapter</a>
					</li>
 																<li class="none">
									<a href="../log4j-to-slf4j/index.html" title="Log4j 2 to SLF4J Adapter">Log4j 2 to SLF4J Adapter</a>
					</li>
 																<li class="none">
									<a href="../log4j-flume-ng/index.html" title="Apache Flume Appender">Apache Flume Appender</a>
					</li>
 																<li class="none">
									<a href="../log4j-taglib/index.html" title="Log4j Tag Library">Log4j Tag Library</a>
					</li>
 																<li class="none">
									<a href="../log4j-jmx-gui/index.html" title="Log4j JMX GUI">Log4j JMX GUI</a>
					</li>
 																<li class="none">
									<a href="../log4j-web/index.html" title="Log4j Web Application Support">Log4j Web Application Support</a>
					</li>
 																<li class="none">
									<a href="../log4j-nosql/index.html" title="Log4j NoSQL support">Log4j NoSQL support</a>
					</li>
 																<li class="none">
									<a href="../log4j-iostreams/index.html" title="Log4j IO Streams">Log4j IO Streams</a>
					</li>
 								</ul>
			<ul class="nav nav-list">
		 											 <li class="nav-header"><i class="icon-info-sign"></i>Project Information</li>
																						<li class="none">
									<a href="../dependencies.html" title="Dependencies">Dependencies</a>
					</li>
 																<li class="none">
									<a href="../dependency-convergence.html" title="Dependency Convergence">Dependency Convergence</a>
					</li>
 																<li class="none">
									<a href="../dependency-management.html" title="Dependency Management">Dependency Management</a>
					</li>
 																<li class="none">
									<a href="../team-list.html" title="Project Team">Project Team</a>
					</li>
 																<li class="none">
									<a href="../mail-lists.html" title="Mailing Lists">Mailing Lists</a>
					</li>
 																<li class="none">
									<a href="../issue-tracking.html" title="Issue Tracking">Issue Tracking</a>
					</li>
 																<li class="none">
									<a href="../license.html" title="Project License">Project License</a>
					</li>
 																<li class="none">
									<a href="../source-repository.html" title="Source Repository">Source Repository</a>
					</li>
 																<li class="none">
									<a href="../project-summary.html" title="Project Summary">Project Summary</a>
					</li>
 								</ul>
			<ul class="nav nav-list">
		 											 <li class="nav-header"><i class="icon-cog"></i>Project Reports</li>
																						<li class="none">
									<a href="../changes-report.html" title="Changes Report">Changes Report</a>
					</li>
 																<li class="none">
									<a href="../jira-report.html" title="JIRA Report">JIRA Report</a>
					</li>
 																<li class="none">
									<a href="../surefire-report.html" title="Surefire Report">Surefire Report</a>
					</li>
 																<li class="none">
									<a href="../rat-report.html" title="RAT Report">RAT Report</a>
					</li>
 								</ul>
							</div>
						<div id="poweredBy">
															<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
				<img class="poweredBy" alt="Built by Maven" src="../images/maven-feather.png" />
			</a>
									</div>
					</td>
					<td class="content">
						<!-- Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

         http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License. -->
    
      <div class="section">
<h2><a name="Extending_Log4j"></a>Extending Log4j</h2>
        
<p>
          Log4j 2 provides numerous ways that it can be manipulated and extended. This section includes an
          overview of the various ways that are directly supported by the Log4j 2 implementation.
        </p>
          
<div class="section">
<h3><a name="LoggerContextFactory"></a>LoggerContextFactory</h3>
            
<p>
              The <tt>LoggerContextFactory</tt> binds the Log4j API to its implementation. The Log4j
              <tt>LogManager</tt> locates a <tt>LoggerContextFactory</tt> by locating all instances of
              <tt>META-INF/log4j-provider.properties</tt>, a standard <tt>java.util.Properties</tt> file,
              and then inspecting each to verify that it specifies a value for the <var>Log4jAPIVersion</var> property
              that conforms to the version required by the <tt>LogManager</tt>. If more than one valid
              implementation is located the value for <var>FactoryPriority</var> will be used to identify the factory
              with the highest priority. Finally, the value of the <var>LoggerContextFactory</var> property will be
              used to locate the <tt>LoggerContextFactory</tt>. In Log4j 2 this is provided by
              <tt>Log4jContextFactory</tt>.
            </p>
            
<p>
              Applications may change the LoggerContextFactory that will be used by
            </p>
            
<ol style="list-style-type: decimal">
              
<li>Implementing a new <tt>LoggerContextFactory</tt> and creating a <tt>log4j-provider.properties</tt>
                to reference it making sure that it has the highest priority.
              </li>
              
<li>Create a new <tt>log4j-provider.xml</tt> and configure it with the desired
                <tt>LoggerContextFactory</tt> making sure that it has the highest priority.
              </li>
              
<li>Setting the system property <var>log4j2.loggerContextFactory</var> to the name of the
                <tt>LoggerContextFactory</tt> class to use.
              </li>
              
<li>Setting the property &quot;log4j2.loggerContextFactory&quot; in a properties file named
                &quot;log4j2.LogManager.properties&quot; to the name of the LoggerContextFactory class to use. The properties
                file must be on the classpath.
              </li>
            </ol>
          </div>
          
<div class="section">
<h3><a name="ContextSelector"></a>ContextSelector</h3>
            
<p>
              ContextSelectors are called by the
              <a href="../log4j-core/apidocs/org/apache/logging/log4j/core/impl/Log4jContextFactory.html">Log4j
              LoggerContext factory</a>. They perform the actual work of
              locating or creating a LoggerContext, which is the anchor for Loggers and their configuration.
              ContextSelectors are free to implement any mechanism they desire to manage LoggerContexts. The
              default Log4jContextFactory checks for the presence of a System Property named &quot;Log4jContextSelector&quot;.
              If found, the property is expected to contain the name of the Class that implements the
              ContextSelector to be used.
            </p>
            
<p>
              Log4j provides five ContextSelectors:
            </p>
            
<dl>
              
<dt><a href="../log4j-core/apidocs/org/apache/logging/log4j/core/selector/BasicContextSelector.html" class="javadoc">BasicContextSelector</a></dt>
              
<dd>Uses either a LoggerContext that has been stored in a ThreadLocal or a common LoggerContext.</dd>
              
<dt><a href="../log4j-core/apidocs/org/apache/logging/log4j/core/selector/ClassLoaderContextSelector.html" class="javadoc">ClassLoaderContextSelector</a></dt>
              
<dd>Associates LoggerContexts with the ClassLoader that created the caller of the getLogger call. This is
              the default ContextSelector.</dd>
              
<dt><a href="../log4j-core/apidocs/org/apache/logging/log4j/core/selector/JndiContextSelector.html" class="javadoc">JndiContextSelector</a></dt>
              
<dd>Locates the LoggerContext by querying JNDI.</dd>
              
<dt><a href="../log4j-core/apidocs/org/apache/logging/log4j/core/async/AsyncLoggerContextSelector.html" class="javadoc">AsyncLoggerContextSelector</a></dt>
              
<dd>Creates a LoggerContext that ensures that all loggers are AsyncLoggers.</dd>
              
<dt><a href="../log4j-core/apidocs/org/apache/logging/log4j/core/osgi/BundleContextSelector.html" class="javadoc">BundleContextSelector</a></dt>
              
<dd>Associates LoggerContexts with the ClassLoader of the bundle that created the caller of the getLogger
              call. This is enabled by default in OSGi environments.</dd>
            </dl>
          </div>
          
<div class="section">
<h3><a name="ConfigurationFactory"></a>ConfigurationFactory</h3>
            
<p>
              Modifying the way in which logging can be configured is usually one of the areas with the most
              interest. The primary method for doing that is by implementing or extending a ConfigurationFactory.
              Log4j provides two ways of adding new ConfigurationFactories. The first is by defining the system
              property named &quot;log4j.configurationFactory&quot; to the name of the class that should be searched first
              for a configuration. The second method is by defining the ConfigurationFactory as a Plugin.
            </p>
            
<p>
              All the ConfigurationFactories are then processed in order. Each factory is called on its
              getSupportedTypes method to determine the file extensions it supports. If a configuration file
              is located with one of the specified file extensions then control is passed to that
              ConfigurationFactory to load the configuration and create the Configuration object.
            </p>
            
<p>
              Most Configuration extend the BaseConfiguration class. This class expects that the subclass will
              process the configuration file and create a hierarchy of Node objects. Each Node is fairly simple
              in that it consists of the name of the node, the name/value pairs associated with the node, The
              PluginType of the node and a List of all of its child Nodes. BaseConfiguration will then be
              passed the Node tree and instantiate the configuration objects from that.
            </p>
            
<div>
<pre class="prettyprint linenums">
@Plugin(name = &quot;XMLConfigurationFactory&quot;, category = &quot;ConfigurationFactory&quot;)
@Order(5)
public class XMLConfigurationFactory extends ConfigurationFactory {

    /**
     * Valid file extensions for XML files.
     */
    public static final String[] SUFFIXES = new String[] {&quot;.xml&quot;, &quot;*&quot;};

    /**
     * Return the Configuration.
     * @param source The InputSource.
     * @return The Configuration.
     */
    public Configuration getConfiguration(InputSource source) {
        return new XMLConfiguration(source, configFile);
    }

    /**
     * Returns the file suffixes for XML files.
     * @return An array of File extensions.
     */
    public String[] getSupportedTypes() {
        return SUFFIXES;
    }
}</pre></div>
          </div>
          
<div class="section">
<h3><a name="LoggerConfig"></a>LoggerConfig</h3>
            
<p>
              LoggerConfig objects are where Loggers created by applications tie into the configuration. The Log4j
              implementation requires that all LoggerConfigs be based on the LoggerConfig class, so applications
              wishing to make changes must do so by extending the LoggerConfig class. To declare the new
              LoggerConfig, declare it as a Plugin of type &quot;Core&quot; and providing the name that applications
              should specify as the element name in the configuration. The LoggerConfig should also define
              a PluginFactory that will create an instance of the LoggerConfig.
            </p>
            
<p>
              The following example shows how the root LoggerConfig simply extends a generic LoggerConfig.
            </p>
            
<div>
<pre class="prettyprint linenums">
@Plugin(name = &quot;root&quot;, category = &quot;Core&quot;, printObject = true)
public static class RootLogger extends LoggerConfig {

    @PluginFactory
    public static LoggerConfig createLogger(@PluginAttribute(value = &quot;additivity&quot;, defaultBooleanValue = true) boolean additivity,
                                            @PluginAttribute(value = &quot;level&quot;, defaultStringValue = &quot;ERROR&quot;) Level level,
                                            @PluginElement(&quot;AppenderRef&quot;) AppenderRef[] refs,
                                            @PluginElement(&quot;Filters&quot;) Filter filter) {
        List&lt;AppenderRef&gt; appenderRefs = Arrays.asList(refs);
        return new LoggerConfig(LogManager.ROOT_LOGGER_NAME, appenderRefs, filter, level, additivity);
    }
}</pre></div>
          </div>
          
<div class="section">
<h3><a name="LogEventFactory"></a>LogEventFactory</h3>
            
<p>A LogEventFactory is used to generate LogEvents. Applications may replace the standard LogEventFactory
              by setting the value of the system property Log4jLogEventFactory to the name of the custom
              LogEventFactory class. </p>
          </div>
          
<div class="section">
<h3><a name="Lookups"></a>Lookups</h3>
            
<p>
              Lookups are the means in which parameter substitution is performed. During Configuration initialization
              an &quot;Interpolator&quot; is created that locates all the Lookups and registers them for use when a variable
              needs to be resolved. The interpolator matches the &quot;prefix&quot; portion of the variable name to a
              registered Lookup and passes control to it to resolve the variable.
            </p>
            
<p>
              A Lookup must be declared using a Plugin annotation with a type of &quot;Lookup&quot;. The name specified on
              the Plugin annotation will be used to match the prefix.  Unlike other Plugins, Lookups do not
              use a PluginFactory. Instead, they are required to provide a constructor that accepts no arguments.
              The example below shows a Lookup that will return the value of a System Property.
            </p>
            
<p>The provided Lookups are documented here: <a href="./lookups.html">Lookups</a></p>
            
<div>
<pre class="prettyprint linenums">
@Plugin(name = &quot;sys&quot;, category = &quot;Lookup&quot;)
public class SystemPropertiesLookup implements StrLookup {

    /**
     * Lookup the value for the key.
     * @param key  the key to be looked up, may be null
     * @return The value for the key.
     */
    public String lookup(String key) {
        return System.getProperty(key);
    }

    /**
     * Lookup the value for the key using the data in the LogEvent.
     * @param event The current LogEvent.
     * @param key  the key to be looked up, may be null
     * @return The value associated with the key.
     */
    public String lookup(LogEvent event, String key) {
        return System.getProperty(key);
    }
}</pre></div>
          </div>
          
<div class="section">
<h3><a name="Filters"></a>Filters</h3>
            
<p>
              As might be expected, Filters are the used to reject or accept log events as they pass through the
              logging system. A Filter is declared using a Plugin annotation of type &quot;Core&quot; and an elementType of
              &quot;filter&quot;. The name attribute on the Plugin annotation is used to specify the name of the element
              users should use to enable the Filter. Specifying the printObject attribute with a value of &quot;true&quot;
              indicates that a call to toString will format the arguments to the filter as the configuration
              is being processed. The Filter must also specify a PluginFactory method that will be called to
              create the Filter.
            </p>
            
<p>
              The example below shows a Filter used to reject LogEvents based upon their logging level. Notice the
              typical pattern where all the filter methods resolve to a single filter method.
            </p>
            
<div>
<pre class="prettyprint linenums">
@Plugin(name = &quot;ThresholdFilter&quot;, category = &quot;Core&quot;, elementType = &quot;filter&quot;, printObject = true)
public final class ThresholdFilter extends AbstractFilter {

    private final Level level;

    private ThresholdFilter(Level level, Result onMatch, Result onMismatch) {
        super(onMatch, onMismatch);
        this.level = level;
    }

    public Result filter(Logger logger, Level level, Marker marker, String msg, Object[] params) {
        return filter(level);
    }

    public Result filter(Logger logger, Level level, Marker marker, Object msg, Throwable t) {
        return filter(level);
    }

    public Result filter(Logger logger, Level level, Marker marker, Message msg, Throwable t) {
        return filter(level);
    }

    @Override
    public Result filter(LogEvent event) {
        return filter(event.getLevel());
    }

    private Result filter(Level level) {
        return level.isAtLeastAsSpecificAs(this.level) ? onMatch : onMismatch;
    }

    @Override
    public String toString() {
        return level.toString();
    }

    /**
     * Create a ThresholdFilter.
     * @param loggerLevel The log Level.
     * @param match The action to take on a match.
     * @param mismatch The action to take on a mismatch.
     * @return The created ThresholdFilter.
     */
    @PluginFactory
    public static ThresholdFilter createFilter(@PluginAttribute(value = &quot;level&quot;, defaultStringValue = &quot;ERROR&quot;) Level level,
                                               @PluginAttribute(value = &quot;onMatch&quot;, defaultStringValue = &quot;NEUTRAL&quot;) Result onMatch,
                                               @PluginAttribute(value = &quot;onMismatch&quot;, defaultStringValue = &quot;DENY&quot;) Result onMismatch) {
        return new ThresholdFilter(level, onMatch, onMismatch);
    }
}</pre></div>
          </div>
          
<div class="section">
<h3><a name="Appenders"></a>Appenders</h3>
            
<p>
              Appenders are passed an event, (usually) invoke a Layout to format the event, and then &quot;publish&quot;
              the event in whatever manner is desired. Appenders are declared as Plugins with a type of &quot;Core&quot;
              and an elementType of &quot;appender&quot;. The name attribute on the Plugin annotation specifies the name
              of the element users must provide in their configuration to use the Appender. Appenders should
              specify printObject as &quot;true&quot; if the toString method renders the values of the attributes passed
              to the Appender.
            </p>
            
<p>
              Appenders must also declare a PluginFactory method that will create the appender. The example
              below shows an Appender named &quot;Stub&quot; that can be used as an initial template.
            </p>
            
<p>
              Most Appenders use Managers. A manager actually &quot;owns&quot; the resources, such as an OutputStream or
              socket. When a reconfiguration occurs a new Appender will be created. However, if nothing significant
              in the previous Manager has changed, the new Appender will simply reference it instead of creating a
              new one. This insures that events are not lost while a reconfiguration is taking place without
              requiring that logging pause while the reconfiguration takes place.
            </p>
            
<div>
<pre class="prettyprint linenums">
@Plugin(name = &quot;Stub&quot;, category = &quot;Core&quot;, elementType = &quot;appender&quot;, printObject = true)
public final class StubAppender extends OutputStreamAppender {

    private StubAppender(String name, Layout layout, Filter filter, StubManager manager,
                         boolean ignoreExceptions) {
    }

    @PluginFactory
    public static StubAppender createAppender(@PluginAttribute(&quot;name&quot;) String name,
                                              @PluginAttribute(&quot;ignoreExceptions&quot;) boolean ignoreExceptions,
                                              @PluginElement(&quot;Layout&quot;) Layout layout,
                                              @PluginElement(&quot;Filters&quot;) Filter filter) {

        if (name == null) {
            LOGGER.error(&quot;No name provided for StubAppender&quot;);
            return null;
        }

        StubManager manager = StubManager.getStubManager(name);
        if (manager == null) {
            return null;
        }
        if (layout == null) {
            layout = PatternLayout.createDefaultLayout();
        }
        return new StubAppender(name, layout, filter, manager, ignoreExceptions);
    }
}</pre></div>
          </div>
          
<div class="section">
<h3><a name="Layouts"></a>Layouts</h3>
            
<p>
              Layouts perform the formatting of events into the printable text that is written by Appenders to
              some destination. All Layouts must implement the Layout interface. Layouts that format the
              event into a String should extend AbstractStringLayout, which will take care of converting the
              String into the required byte array.
            </p>
            
<p>
              Every Layout must declare itself as a plugin using the Plugin annotation. The type must be &quot;Core&quot;,
              and the elementType must be &quot;Layout&quot;. printObject should be set to true if the plugin's toString
              method will provide a representation of the object and its parameters. The name of the plugin must
              match the value users should use to specify it as an element in their Appender configuration.
              The plugin also must provide a static method annotated as a PluginFactory and with each of the
              methods parameters annotated with PluginAttr or PluginElement as appropriate.
            </p>
            
<div>
<pre class="prettyprint linenums">
@Plugin(name = &quot;SampleLayout&quot;, category = &quot;Core&quot;, elementType = &quot;layout&quot;, printObject = true)
public class SampleLayout extends AbstractStringLayout {

    protected SampleLayout(boolean locationInfo, boolean properties, boolean complete,
                           Charset charset) {
    }

    @PluginFactory
    public static SampleLayout createLayout(@PluginAttribute(&quot;locationInfo&quot;) boolean locationInfo,
                                            @PluginAttribute(&quot;properties&quot;) boolean properties,
                                            @PluginAttribute(&quot;complete&quot;) boolean complete,
                                            @PluginAttribute(value = &quot;charset&quot;, defaultStringValue = &quot;UTF-8&quot;) Charset charset) {
        return new SampleLayout(locationInfo, properties, complete, charset);
    }
}</pre></div>
          </div>
          
<div class="section">
<h3><a name="PatternConverters"></a>PatternConverters</h3>
            
<p>
              PatternConverters are used by the PatternLayout to format the log event into a printable String. Each
              Converter is responsible for a single kind of manipulation, however Converters are free to format
              the event in complex ways. For example, there are several converters that manipulate Throwables and
              format them in various ways.
            </p>
            
<p>
              A PatternConverter must first declare itself as a Plugin using the standard Plugin annotation but
              must specify value of &quot;Converter&quot; on the type attribute. Furthermore, the Converter must also
              specify the ConverterKeys attribute to define the tokens that can be specified in the pattern
              (preceded by a '%' character) to identify the Converter.
            </p>
            
<p>
              Unlike most other Plugins, Converters do not use a PluginFactory. Instead, each Converter is
              required to provide a static newInstance method that accepts an array of Strings as the only
              parameter. The String array are the values that are specified within the curly braces that can
              follow the converter key.
            </p>
            
<p>
              The following shows the skeleton of a Converter plugin.
            </p>
            
<div>
<pre class="prettyprint linenums">
@Plugin(name = &quot;query&quot;, category = &quot;Converter&quot;)
@ConverterKeys({&quot;q&quot;, &quot;query&quot;})
public final class QueryConverter extends LogEventPatternConverter {

    public QueryConverter(String[] options) {
    }

    public static QueryConverter newInstance(final String[] options) {
      return new QueryConverter(options);
    }
}</pre></div>
          </div>
          
<div class="section">
<h3><a name="Custom_Plugins"></a>Custom Plugins</h3>
            
<p>See the <a href="plugins.html">Plugins</a> section of the manual.</p>
<!-- TODO: some documentation here! -->
          </div>
      </div>

    

					</td>
				</tr>
			</table>
		</div>

		<div class="footer">
							<p>Copyright &copy; 1999-2021 <a class="external" href="http://www.apache.org">Apache Software Foundation</a>. All Rights Reserved.</p>
				<p>Apache Logging, Apache Log4j, Log4j, Apache, the Apache feather logo, and the Apache Logging project logo are trademarks of The Apache Software Foundation.</p>
				<p>Site powered by <a class="external" href="http://getbootstrap.com/">Twitter Bootstrap</a>. Icons from <a class="external" href="http://glyphicons.com/">Glyphicons Free</a>.</p>
			</div>
		</div>
	</body>
</html>
